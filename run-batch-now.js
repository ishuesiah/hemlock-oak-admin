// run-batch-now.js - Just run it! No configuration needed.
require('dotenv').config();
const { ShipStationAPI } = require('./shipstation-add-item');

// YOUR ORDERS
const orders = ['46993', '47021', '46918', '47145', '47191', '47201', '47213', '47239', '47371', '47217', '47677', '47720', '47782', '47784', '47795', '47908', '48033', '48169', '48370', '48360', '48431', '48410', '48460', '48519', '48580', '48594', '48638', '48687', '48761', '48789', '48973', '49089', '49105', '49121', '49123', '49205', '49239', '49237', '49271', '49428', '49429', '49467', '49431', '49529', '49594', '49631', '49653', '49663', '49689', '49723', '49740', '49770', '49807', '49822', '49825', '49870', '49869', '49877', '49880', '49888', '49894', '49971', '49981', '49992', '50046', '50048', '50059', '50060', '50078', '50142', '50240', '50248', '50273', '50288', '50366', '50369', '50386', '50326', '50331', '50397', '50413', '50435', '50482', '50503', '50581', '50598', '50532', '50572', '50610', '50623', '50688', '50774', '50791', '50897', '50936', '51003', '51039', '51081', '51102', '51173', '51186', '49366', '51287', '51331', '50016', '51347', '51365', '51386', '51413', '51418', '51446', '51451', '51450', '51454', '51487', '51493', '51527', '49460', '51612', '51622', '51638', '51180', '51708', '51732', '51796', '51847', '51901', '51935', '51948', '51961', '51689', '52026', '52031', '52103', '52109', '52121', '52118', '52140', '52179', '52181', '52318', '52322', '52270', '52341', '52384', '52405', '49703', '49703', '52326', '50727', '49814', '50394', '49922', '50728', '51196', '52462', '52104', '50910', '51362', '52136', '52271', '49642', '49656', '49687', '49762', '49713', '49821', '49890', '49621', '49451', '49362', '49367', '49421', '49285', '49304', '49260', '49178', '49190', '49200', '51229', '51230', '51119', '51014', '50915', '50769', '50698', '50710', '50645', '50651', '50681', '50683', '50600', '49898', '50009', '49987', '50117', '50132', '50138', '50299', '50308', '50516', '49120', '52021', '52340', '52345', '52280', '52285', '52147', '52215', '52259', '52110', '52046', '52051', '51421', '51470', '51484', '51395', '51410', '51353', '51999', '51810', '51756', '51691', '51701', '51627', '51678', '52371', '52385', '50341', '50606', '50613', '50578', '51001', '51054', '49337'];

// OPTIONAL: Custom item configuration (if you want to override defaults)
// Leave as null to use defaults: LIST-DEF, "Complimentary stickers", 2 qty @ $0.50 = $1.00
const customItem = null; // or { sku: 'CUSTOM-SKU', name: 'Custom Item', quantity: 1, price: 2.50 }

async function go() {
  console.log(`\nüöÄ Adding stickers to ${orders.length} orders...\n`);
  
  const api = new ShipStationAPI();
  await api.loadCUSMA('./data/CUSMA.csv');
  
  let success = 0, skip = 0, fail = 0;
  
  for (const order of orders) {
    process.stdout.write(`${order}... `);
    try {
      const result = await api.addItemToOrder(order, customItem);
      if (result.message.includes('already exists')) {
        console.log('‚è© skipped');
        skip++;
      } else {
        console.log('‚úÖ added');
        success++;
      }
      await new Promise(r => setTimeout(r, 1000)); // Rate limit
    } catch (e) {
      console.log(`‚ùå failed: ${e.message}`);
      fail++;
    }
  }
  
  console.log(`\n‚ú® DONE! Success: ${success}, Skipped: ${skip}, Failed: ${fail}\n`);
}

go();